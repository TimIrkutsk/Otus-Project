@startuml
!include <C4/C4_Context>

title Система управления запасами - Контекстная диаграмма (Уровень 1)

Person(operator, "Оператор линии", "Получает задания, проводит инвентаризацию, утилизацию и пополнение")
Person(technologist, "Технолог", "Настраивает справочники, правила автозаказа, утверждает заказы")
Person(admin, "Администратор системы", "Управляет пользователями и правами доступа")

System(system, "Система управления запасами", "Автоматизирует контроль сроков, инвентаризацию, автозаказ и задания операторам")

System_Ext(robot, "Роботизированная линия", "Промышленный робот для приготовления блюд")
System_Ext(logistics, "Логистический центр", "Центральный склад поставщика полуфабрикатов")
System_Ext(sales, "Система продаж", "Источник данных о прогнозах спроса")

' Основные взаимодействия
Rel(operator, system, "Получает задания\nПроводит инвентаризацию\nФиксирует утилизацию и перемещения", "Мобильное приложение\nОффлайн-режим")
Rel(technologist, system, "Управляет заказами\nАнализирует отчеты\nНастраивает правила и справочники", "Веб-интерфейс")
Rel(admin, system, "Управляет пользователями\nНастраивает роли и права", "Веб-интерфейс")

Rel(robot, system, "Запрашивает разрешение на использование\nСообщает о списаниях", "gRPC/WebSocket\n<100 мс")
Rel(system, robot, "Блокирует просроченные партии\nПередает данные об остатках", "gRPC/WebSocket\nРеальное время")

Rel(system, logistics, "Передает заказы\nПолучает данные о партиях", "REST API\nJSON/XML\nАутентификация")
Rel(logistics, system, "Подтверждает заказы\nПередает данные о поставках", "REST API")

Rel(system, sales, "Получает прогноз продаж", "REST API\nJSON")

' Критические требования
Note right of system {
  <b>Ключевые требования:</b>
  • Масштабируемость до 100 ресторанов
  • Интеграция с роботом <100 мс
  • Автоматические задания операторам
  • Поддержка Kafka для очередей
  • Доступность 99.9%
  • Оффлайн-работа мобильного приложения
  • Контроль сроков годности FEFO
}
@enduml